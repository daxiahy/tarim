var ArticleChannel={ws:void 0,init:function(e){ArticleChannel.ws=new ReconnectingWebSocket(e),ArticleChannel.ws.reconnectInterval=1e4,ArticleChannel.ws.onopen=function(){setInterval(function(){ArticleChannel.ws.send("-hb-")},18e4)},ArticleChannel.ws.onmessage=function(e){var n=JSON.parse(e.data);if(Label.articleOId===n.articleId)switch(n.type){case"comment":var t=parseInt($(".comments-header .article-cmt-cnt").text())+1;if($(".comments-header .article-cmt-cnt").text(t+" "+Label.cmtLabel),0===$("#comments .list > ul > li").length&&($(".comment-header > .fn-none").show(),$(".comments-header > .fn-none").show(),$("#articleCommentsPanel").parent().show()),0===Label.userCommentViewMode?$("#comments > .list > ul").append(n.cmtTpl):$("#comments > .list > ul").prepend(n.cmtTpl),$("#"+n.commentId+" .cmt-via").text(Util.getDeviceByUa(n.commentUA)),Label.currentUserName===n.commentAuthorName&&Comment._bgFade($("#"+n.commentId)),hljs.initHighlighting.called=!1,hljs.initHighlighting(),""!==n.commentOriginalCommentId){var a=$("#"+n.commentOriginalCommentId),i=a.find(".comment-action > .ft-fade > .fn-pointer");1===i.length?(i.html(" "+(parseInt($.trim(i.text()))+1)+" "+Label.replyLabel+' <span class="'+i.find("span").attr("class")+'"></span>'),"icon-chevron-up"===i.find("span").attr("class")&&(i.find("span").removeClass("icon-chevron-up").addClass("icon-chevron-down"),i.click())):a.find(".comment-action > .ft-fade").prepend('<span class="fn-pointer ft-smaller fn-left" onclick="Comment.showReply(\''+n.commentOriginalCommentId+"', this, 'comment-replies')\" style=\"opacity: 1;\"> 1 "+Label.replyLabel+' <span class="icon-chevron-down"></span>')}break;case"articleHeat":var o=$("#heatBar"),l=$(".heat");"+"===n.operation?(o.append('<i class="point"></i>'),setTimeout(function(){l.width($(".heat").width()+3),o.find(".point").remove()},2e3)):(l.width($(".heat").width()-3),o.append('<i class="point-remove"></i>'),setTimeout(function(){o.find(".point-remove").remove()},2e3));break;default:console.error("Wrong data [type="+n.type+"]")}},ArticleChannel.ws.onclose=function(){},ArticleChannel.ws.onerror=function(e){console.log(e)}}},ArticleListChannel={ws:void 0,init:function(e){ArticleListChannel.ws=new ReconnectingWebSocket(e),ArticleListChannel.ws.reconnectInterval=1e4,ArticleListChannel.ws.onopen=function(){setInterval(function(){ArticleListChannel.ws.send("-hb-")},18e4)},ArticleListChannel.ws.onmessage=function(e){var n=JSON.parse(e.data);$(".article-list h2 > a[rel=bookmark]").each(function(){var e=$(this).data("id").toString();if(n.articleId===e){var t=$(this).closest("li"),a=t.find(".heat");"+"===n.operation?(t.append('<i class="point"></i>'),setTimeout(function(){a.width(a.width()+3),t.find(".point").remove()},2e3)):(a.width(a.width()-3),t.append('<i class="point-remove"></i>'),setTimeout(function(){t.find(".point-remove").remove()},2e3))}})},ArticleListChannel.ws.onclose=function(){ArticleListChannel.ws.close()},ArticleListChannel.ws.onerror=function(e){console.log("ERROR",e)}}},TimelineChannel={ws:void 0,init:function(e,n){TimelineChannel.ws=new ReconnectingWebSocket(e),TimelineChannel.ws.reconnectInterval=1e4,TimelineChannel.ws.onopen=function(){setInterval(function(){TimelineChannel.ws.send("-hb-")},18e4)},TimelineChannel.ws.onmessage=function(e){var t=JSON.parse(e.data);switch($("#emptyTimeline").remove(),t.type){case"newUser":case"article":case"comment":case"activity":$(".timeline").show();var a=(new Date).getTime(),i='<li class="fn-none" id='+a+">"+t.content+"</li>";$(".timeline > ul").prepend(i),$(".timeline > ul > li:first").fadeIn(2e3);$(".timeline > ul > li").length>n&&$(".timeline > ul  > li:last").remove()}},TimelineChannel.ws.onclose=function(){TimelineChannel.ws.close()},TimelineChannel.ws.onerror=function(e){console.log("ERROR",e)}}},ChatRoomChannel={ws:void 0,init:function(e){ChatRoomChannel.ws=new ReconnectingWebSocket(e),ChatRoomChannel.ws.reconnectInterval=1e4,ChatRoomChannel.ws.onopen=function(){setInterval(function(){ChatRoomChannel.ws.send("-hb-")},18e4)},ChatRoomChannel.ws.onmessage=function(e){var n=JSON.parse(e.data);switch(n.type){case"online":$("#onlineCnt").text(n.onlineChatCnt);break;case"msg":var t=n.userAvatarURL.indexOf("user-thumbnail.png")<0,a='<a rel="nofollow" href="/member/'+n.userName+'"><div class="avatar tooltipped tooltipped-se" aria-label="'+n.userName+'" style="background-image:url('+n.userAvatarURL+')"></div></a>';t||(a='<div class="avatar tooltipped tooltipped-se" aria-label="'+n.userName+'" style="background-image:url('+n.userAvatarURL+')"></div>');var i='<a rel="nofollow" href="/member/'+n.userName+'">'+n.userName+"</a>";t||(i=n.userName);var o='<li class="fn-none"><div class="fn-flex">'+a+'<div class="fn-flex-1"><div class="fn-clear"><span class="fn-left">'+i+'</span></div><div class="content-reset comment">'+n.content+"</div></div></div></li>";0===$(".list ul li").length?$(".list ul").html(o):$(".list ul li:first").before(o),$(".list").scrollTop()<2*$("li").outerHeight()&&$(".list").animate({scrollTop:0},500),$(".list li:first").fadeIn(2e3)}},ChatRoomChannel.ws.onclose=function(){ChatRoomChannel.ws.close()},ChatRoomChannel.ws.onerror=function(e){console.log("ERROR",e)}}},GobangChannel={ws:void 0,init:function(e){GobangChannel.ws=new ReconnectingWebSocket(e),GobangChannel.ws.reconnectInterval=1e4,GobangChannel.ws.onopen=function(){setInterval(function(){GobangChannel.ws.send("zephyr test")},18e4)},GobangChannel.ws.onmessage=function(e){switch(JSON.parse(e.data).type){case"gobangPlayer":console.log("data.type:>gobangPlayer");break;case"msg":console.log("data.type:>msg")}},GobangChannel.ws.onclose=function(){GobangChannel.ws.close()},GobangChannel.ws.onerror=function(e){console.log("ERROR",e)}}};